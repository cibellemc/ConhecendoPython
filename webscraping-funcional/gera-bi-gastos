import pandas as pd

# Ler o arquivo Excel
df = pd.read_excel('<entrar com caminho>')

# Remover espaços em branco no nome das colunas
df.columns = df.columns.str.strip()

# Converter o DataFrame em uma lista de dicionários
result = []
for col in df.columns[1:]:
    pacote = df[col].name
    gastos = []
    for i, row in df.iterrows():
        if i >= 0:
            mes = row['Classes de custo']
            valor = row[col]
            gastos.append({"Valor": valor, "Mês": mes})
    result.append({"Pacote": pacote, "Gasto": gastos})

#print(result[0])
df = pd.json_normalize(result, 'Gasto', ['Pacote'])
df.columns = ['Valor', 'Subpacote', 'Mês']
df['Mês'] = df['Mês'].str.strip()
df['Tipo'] = "ORÇADO"

df.to_excel('<entrar com caminho>', index=False)

print(df)
